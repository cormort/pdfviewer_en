<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Keyword Search Platform</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app-container">
    <div id="toolbar-toggle-tab">
        <span class="icon">‚Ä∫</span>
    </div>

    <div id="toolbar">
      <div class="title-container">
        <a href="instructions.html" target="_blank" rel="noopener noreferrer" title="Open user guide in a new tab" id="help-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
          </svg>
        </a>
      </div>
      
      <div id="restore-session-container" style="display: none; width: 100%; text-align: center; margin-bottom: 10px;">
        <button id="restore-session-btn" style="width: 100%; padding: 10px; background-color: #28a745; color: white; border-color: #28a745; cursor: pointer;">Restore Last Session</button>
      </div>
      
      <div id="file-selection-container">
        <label for="fileInput" style="display: block; font-size: 0.9em; margin-bottom: -5px;">Choose one or more PDF files:</label>
        <input type="file" id="fileInput" accept="application/pdf" multiple />
        <button id="clear-session-btn" style="display: none; width: 100%; margin-top: 5px;">Clear / Re-select</button>
      </div>

      <input type="text" id="searchInput" placeholder="Keyword or Regex" />
      <button id="search-action-button">Search</button>
      
      <div id="desktop-zoom-controls" class="zoom-controls">
        <button id="zoom-out-btn" title="Zoom Out">-</button>
        <button id="fit-height-btn" title="Fit to Page Height">Fit Height</button>
        <button id="fit-width-btn" title="Fit to Page Width">Fit Width</button>
        <button id="zoom-in-btn" title="Zoom In">+</button>
      </div>

      <div id="local-magnifier-zoom-controls" style="display: none; align-items: center; gap: 5px;">
        <label for="local-magnifier-zoom-selector" style="white-space: nowrap; font-size: 0.9em;">Magnifier Zoom:</label>
        <select id="local-magnifier-zoom-selector" style="padding: 6px;">
            <option value="1.5">1.5x</option>
            <option value="2.0">2.0x</option>
            <option value="2.5" selected>2.5x</option>
            <option value="3.0">3.0x</option>
            <option value="3.5">3.5x</option>
        </select>
      </div>

      <div id="mobile-zoom-controls" class="zoom-controls">
        <button id="mobile-zoom-out-btn" title="Zoom Out">-</button>
        <button id="mobile-fit-height-btn" title="Fit to Page Height">Fit Height</button>
        <button id="mobile-fit-width-btn" title="Fit to Page Width">Fit Width</button>
        <button id="mobile-zoom-in-btn" title="Zoom In">+</button>
      </div>

      <div id="page-navigation">
        <button id="go-to-first-page">First Page</button>
        <button id="prev-page">Prev</button>
        <input type="range" id="page-slider" min="1" max="1" value="1" disabled>
        <span id="page-num-display">- / -</span>
        <button id="next-page">Next</button>
        <div>
            <input type="number" id="page-to-go" min="1" placeholder="Page">
            <button id="go-to-page-btn">Go</button>
        </div>
      </div>
    </div>

    <div id="main-content">
        <div id="pdf-container">
          <canvas id="pdf-canvas"></canvas>
          <div id="text-layer" class="textLayer"></div>
          <canvas id="drawing-canvas"></canvas>
          <div id="magnifier-glass">
            <canvas id="magnifier-canvas"></canvas>
          </div>
        </div>
        <div id="resizer"></div>
        <div id="search-results-panel">
            <h3>Bookmarks / Search Results</h3>
            <div id="panel-dropdown-container">
                <select id="panelFileFilterDropdown">
                    <option value="all">All Files</option>
                </select>
                <select id="panelResultsDropdown">
                    <option value="">Search Results</option>
                </select>
            </div>
            <div id="results-list"></div>
        </div>
    </div>
  </div>

  <div id="floating-action-buttons">
    <button id="toggle-underline-btn" title="Toggle Search Result Underlines">
        <span class="toggle-underline-icon">S</span>
    </button>
    <div class="fab-button-group">
        <button id="toggle-paragraph-selection-btn" title="Enable Paragraph Selection">¬∂</button>
        <button id="copy-page-text-btn" title="Copy Page Text">üìù</button>
        <button id="toggle-text-selection-btn" title="Enable Text Selection">TS</button>
    </div>
    <div class="fab-button-group">
        <button id="toggle-highlighter-btn" title="Enable Highlighter">üñåÔ∏è</button>
        <button id="clear-highlighter-btn" title="Clear Highlighter Marks">üóëÔ∏è</button>
    </div>
    <button id="toggle-local-magnifier-btn" title="Toggle Magnifier">üîç</button>
    <div class="fab-button-group">
        <button id="export-page-btn" title="Export current page as image">üì∑</button>
        <button id="share-page-btn" title="Share current page">üîó</button>
    </div>
  </div>

<div id="bottom-results-bar">
  <div id="result-nav-wrapper">
    <select id="fileFilterDropdown">
      <option value="all">All Files</option>
    </select>
    <select id="resultsDropdown">
      <option value="">Search Results</option>
    </select>
  </div>
</div>

  <script type="module">
    import { GlobalWorkerOptions } from './lib/pdfjs/pdf.mjs'; 
    GlobalWorkerOptions.workerSrc = './lib/pdfjs/pdf.worker.mjs';
  </script>
  <script type="module" src="./script.js"></script>
</body>
</html>
